<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="br.com.engecopi.saci.QuerySaciTest" tests="3" skipped="0" failures="0" errors="0" timestamp="2019-05-19T20:48:26" hostname="note-ci" time="3.538">
  <properties/>
  <testcase name="pedidos()" classname="br.com.engecopi.saci.QuerySaciTest" time="2.882"/>
  <testcase name="notaSaida()" classname="br.com.engecopi.saci.QuerySaciTest" time="0.509"/>
  <testcase name="notaEntrada()" classname="br.com.engecopi.saci.QuerySaciTest" time="0.144"/>
  <system-out><![CDATA[2019-05-19 17:48:26,051 [Test worker] INFO  br.com.engecopi.estoque.ui.EstoqueUI - Starting up
##################### /home/ivaneyvieira/ebean.properties
2019-05-19 17:48:26,213 [Test worker] WARN  com.jolbox.bonecp.BoneCPConfig - Min Connections > max connections
SQL2O ==> SELECT DISTINCT cast(CONCAT(N.paymno) as char)     AS rota,
                N.storeno,
                N.ordno       AS numero,
                ''            AS serie,
                N.date,
                N.date as dt_emissao,
                P.prdno,
                P.grade,
                P.qtty / 1000 AS quant,
                C.name        AS clienteName,
                'PEDIDO_S'    AS tipo
FROM sqldados.eord AS                    N
       INNER JOIN sqldados.eoprd AS      P USING (storeno, ordno)
       INNER JOIN engEstoque.produtos AS E
         ON E.codigo = P.prdno AND E.grade = P.grade
       LEFT JOIN  sqldados.custp AS      C
         ON C.no = N.custno
WHERE N.paymno = 291 AND
      N.storeno = :storeno AND
      (N.ordno = :nfno)
2019-05-19 17:48:28,941 [Test worker] INFO  br.com.engecopi.estoque.ui.EstoqueUI - Starting up
##################### /home/ivaneyvieira/ebean.properties
SQL2O ==> SELECT CAST(IFNULL(X.xrouteno, '') AS CHAR) AS rota,
       N.storeno,
       N.nfno                               AS numero,
       N.nfse                               AS serie,
       N.issuedate                          AS date,
       N.issuedate                          AS dt_emissao,
       P.prdno                              AS prdno,
       P.grade,
       P.qtty                               AS quant,
       C.name                               AS clienteName,
       CASE WHEN N.nfse = 1 AND N.cfo IN (5922, 6922)
                 THEN ''
            WHEN N.nfse = '66'
                 THEN 'ACERTO_S'
            WHEN N.nfse = '3'
                 THEN 'ENT_RET'
            WHEN tipo = 0
                 THEN 'VENDA'
            WHEN tipo = 1
                 THEN 'TRANSFERENCIA_S'
            WHEN tipo = 2
                 THEN 'DEV_FOR'
            WHEN tipo = 3
                 THEN 'DEV_FOR'
            WHEN tipo = 7
                 THEN 'OUTRAS_NFS'
            ELSE 'SP_REME'
           END                              AS tipo
FROM sqldados.nf AS                      N
       INNER JOIN sqldados.xaprd AS      P USING (storeno, pdvno, xano)
       INNER JOIN engEstoque.produtos AS E
         ON E.codigo = P.prdno AND E.grade = P.grade
       LEFT JOIN  sqldados.custp AS      C
         ON C.no = N.custno
       LEFT JOIN  sqldados.inv AS        I
         ON N.invno = I.invno
       LEFT JOIN  sqldados.xfr AS        X
         ON X.no = I.xfrno
WHERE N.storeno = :storeno AND
      N.nfno = :nfno AND
      N.nfse = :nfse AND
      N.status <> 1
HAVING tipo <> ''
SQL2O ==> SELECT DISTINCT ''            AS rota,
                N.storeno,
                N.nfno AS numero,
                N.nfse AS serie,
                N.date,
                N.date as dt_emissao,
                P.prdno,
                P.grade,
                SUM(P.qtty / 1000) AS quant,
                C.name        AS clienteName,
                CASE WHEN N.nfse = '66'
                          THEN 'ACERTO_S'
                     WHEN N.nfse = '3'
                          THEN 'ENT_RET'
                     ELSE 'VENDA'
                    END       AS tipo
FROM sqlpdv.pxa AS                       N
       INNER JOIN sqlpdv.pxaprd AS       P USING (storeno, pdvno, xano)
       INNER JOIN engEstoque.produtos AS E
         ON E.codigo = P.prdno AND E.grade = P.grade
       LEFT JOIN  sqldados.custp AS      C
         ON C.no = N.custno
WHERE N.storeno = :storeno AND
      N.nfno = :nfno AND
      N.nfse = :nfse AND
      processed = 0
GROUP BY P.storeno, P.pdvno, P.xano, P.prdno, P.grade
2019-05-19 17:48:29,452 [Test worker] INFO  br.com.engecopi.estoque.ui.EstoqueUI - Starting up
##################### /home/ivaneyvieira/ebean.properties
SQL2O ==> 
select P.invno, N.storeno, nfname           as numero, invse as serie,
       CAST(IFNULL(X.xrouteno, '') AS CHAR) AS rota,
       N.date,
       N.issue_date                         AS dt_emissao,
       P.prdno                              AS prdno,
       P.grade, P.qtty/1000                 as quant, V.name as vendName,
  CASE
    WHEN invse = '66' then 'ACERTO_E'
    WHEN type = 0 then "COMPRA"
    WHEN type = 1 then "TRANSFERENCIA_E"
    WHEN type = 2 then "DEV_CLI"
    WHEN type = 8 then "RECLASSIFICACAO_E"
    WHEN type = 10 AND N.remarks LIKE 'DEV%' then "DEV_CLI"
    ELSE "NOTA_E"
  END                                       AS tipo
from sqldados.inv AS N
  inner join sqldados.iprd AS P
  USING(invno)
  inner join sqldados.vend AS V
    ON V.no = N.vendno
  left join sqldados.xfr AS X
    ON X.no = N.xfrno
where N.invno = (SELECT MAX(invno)
                 FROM sqldados.inv AS N
                 where N.storeno = :storeno
                     and nfname = :nfname
                     and invse = :invse
                     AND N.bits & POW(2, 4) = 0
                     AND N.auxShort13 & pow(2, 15) = 0
                     AND invse <> ''
)
UNION
select 0                    as invno, N.storeno, ordno as numero, '' as serie,
       cast(CONCAT(N.paymno) as char)      AS rota,
       N.date,
       N.date,
       P.prdno              AS prdno,
       P.grade, P.qtty/1000 as quant, C.name as vendName,
       'PEDIDO_E'           AS tipo
from sqldados.eord AS N
  inner join sqldados.eoprd AS P
  USING(storeno, ordno)
  inner join engEstoque.produtos AS E
    ON E.codigo = P.prdno AND E.grade = P.grade
  left join sqldados.custp AS C
    ON C.no = N.custno
WHERE N.paymno = 290 AND
      N.storeno = :storeno
      and (N.ordno = :nfname)
      and (:invse = '')
]]></system-out>
  <system-err><![CDATA[]]></system-err>
</testsuite>
